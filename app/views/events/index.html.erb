
<div class="page-header">
	<ul>
		<% if params[:search] == nil %>
			<h3>All Events</h3>
		<% else %>
			<h3>Events with "<%= params[:search] %>" : </h3>
		<% end %>
	</ul>
</div>

<h4><% if can? :my_events, Event.new %>
	Goto <%= link_to "My Events", events_my_events_path %> 
	<%end%>
	<% if can? :create, Event.new %>
		or <%= link_to "Add a new event", new_event_path, class: "btn btn-info" %>
	<% end %>
</h4>


<%= form_tag(events_path, method: "get", class: "form-inline") do %>
	<%= text_field_tag :search, params[:search], prompt: "Enter a keyword...", class: "form-control" %>
	<%= submit_tag "Search",class: "btn btn-default" %>
<% end %>
<br>

<ul class="nav nav-tabs">
	<li role="presentation" class="active"> <a href="/events">Home</a></li>
  <li role="presentation" class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
      Categories <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
      <% @categories.each do |category| %>
      	<li><%= link_to category.name.capitalize, category_path(category) %></li>
      <% end %>
    </ul>
  </li>
</ul>

<table class="table table-striped" >
	<tr >
		<th>Event</th>
		<th>Organiser</th>
		<th>Action</th>
	</tr>
	<% @events.each do |event| %>
	<tr >
		<td><%= link_to "#{event.name.capitalize}", event_path(event) %></td>
		<td><%= event.user.username %></td>
		<td >
			<%= link_to "Show", event_path(event) %>
			<% if can? :update, event %>
				- <%= link_to "Edit", edit_event_path(event) %> - <%= link_to "Delete", event_path(event), method: :delete, data: {confirm: "Are you sure you wanna delete #{event.name} ?"} %>
			<% end %>		
		</td>
	</tr>
	<% end %>
</table>
